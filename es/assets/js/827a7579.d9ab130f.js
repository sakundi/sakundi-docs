"use strict";(self.webpackChunktikuna=self.webpackChunktikuna||[]).push([[701],{5680:(e,n,a)=>{a.d(n,{xA:()=>u,yg:()=>y});var r=a(6540);function i(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function t(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,r)}return a}function o(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?t(Object(a),!0).forEach((function(n){i(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):t(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function l(e,n){if(null==e)return{};var a,r,i=function(e,n){if(null==e)return{};var a,r,i={},t=Object.keys(e);for(r=0;r<t.length;r++)a=t[r],n.indexOf(a)>=0||(i[a]=e[a]);return i}(e,n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);for(r=0;r<t.length;r++)a=t[r],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var s=r.createContext({}),c=function(e){var n=r.useContext(s),a=n;return e&&(a="function"==typeof e?e(n):o(o({},n),e)),a},u=function(e){var n=c(e.components);return r.createElement(s.Provider,{value:n},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},g=r.forwardRef((function(e,n){var a=e.components,i=e.mdxType,t=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=c(a),g=i,y=d["".concat(s,".").concat(g)]||d[g]||p[g]||t;return a?r.createElement(y,o(o({ref:n},u),{},{components:a})):r.createElement(y,o({ref:n},u))}));function y(e,n){var a=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var t=a.length,o=new Array(t);o[0]=g;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l[d]="string"==typeof e?e:i,o[1]=l;for(var c=2;c<t;c++)o[c]=a[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,a)}g.displayName="MDXCreateElement"},7176:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>s,contentTitle:()=>o,default:()=>p,frontMatter:()=>t,metadata:()=>l,toc:()=>c});var r=a(8168),i=(a(6540),a(5680));const t={id:"using-zikuani-third-party",title:"Using Zikuani as a provider",sidebar_label:"Using Zikuani as a provider",description:"Sakundi - Using Zikuani as a provider",keywords:["sakundi","zikuani","identity","wallet"],hide_table_of_contents:!0,custom_edit_url:null},o="\ud83e\uddea Tutorial de Cliente OAuth con Express.js y Credenciales de Conocimiento Cero",l={unversionedId:"user-section/using-zikuani-third-party",id:"user-section/using-zikuani-third-party",title:"Using Zikuani as a provider",description:"Sakundi - Using Zikuani as a provider",source:"@site/i18n/es/docusaurus-plugin-content-docs/current/user-section/using-zikuani-third-party.md",sourceDirName:"user-section",slug:"/user-section/using-zikuani-third-party",permalink:"/es/docs/user-section/using-zikuani-third-party",draft:!1,editUrl:null,tags:[],version:"current",frontMatter:{id:"using-zikuani-third-party",title:"Using Zikuani as a provider",sidebar_label:"Using Zikuani as a provider",description:"Sakundi - Using Zikuani as a provider",keywords:["sakundi","zikuani","identity","wallet"],hide_table_of_contents:!0,custom_edit_url:null},sidebar:"tutorialSidebar",previous:{title:"Instalaci\xf3n del Wallet",permalink:"/es/docs/user-section/client-installation"},next:{title:"\xbfQu\xe9 es ZK Voto Digital?",permalink:"/es/docs/user-section/what-is-zk-voto-digital"}},s={},c=[{value:"\ud83d\udce6 1. Configuraci\xf3n del Proyecto",id:"-1-configuraci\xf3n-del-proyecto",level:2},{value:"Librer\xedas necesarias",id:"librer\xedas-necesarias",level:3},{value:"\ud83d\udd10 2. Configuraci\xf3n del Entorno",id:"-2-configuraci\xf3n-del-entorno",level:2},{value:"\ud83e\uddfe 3. Funci\xf3n para Decodificar JWT",id:"-3-funci\xf3n-para-decodificar-jwt",level:2},{value:"\ud83d\udeaa 4. Ruta Principal <code>/</code>",id:"-4-ruta-principal-",level:2},{value:"\ud83d\udd04 5. Ruta de Callback <code>/callback</code>",id:"-5-ruta-de-callback-callback",level:2},{value:"Paso 1: Validar el c\xf3digo",id:"paso-1-validar-el-c\xf3digo",level:3},{value:"Paso 2: Intercambiar el c\xf3digo por un token de acceso",id:"paso-2-intercambiar-el-c\xf3digo-por-un-token-de-acceso",level:3},{value:"Paso 3: Mostrar los datos del token",id:"paso-3-mostrar-los-datos-del-token",level:3},{value:"\ud83d\ude80 6. Iniciar el Servidor",id:"-6-iniciar-el-servidor",level:2},{value:"\u2705 Resumen",id:"-resumen",level:2},{value:"\ud83d\udd10 Casos de Uso",id:"-casos-de-uso",level:2}],u={toc:c},d="wrapper";function p(e){let{components:n,...a}=e;return(0,i.yg)(d,(0,r.A)({},u,a,{components:n,mdxType:"MDXLayout"}),(0,i.yg)("h1",{id:"-tutorial-de-cliente-oauth-con-expressjs-y-credenciales-de-conocimiento-cero"},"\ud83e\uddea Tutorial de Cliente OAuth con Express.js y Credenciales de Conocimiento Cero"),(0,i.yg)("p",null,"Este tutorial explica c\xf3mo funciona un cliente OAuth 2.0 usando ",(0,i.yg)("inlineCode",{parentName:"p"},"Express.js"),", ",(0,i.yg)("inlineCode",{parentName:"p"},"axios")," y un servidor OAuth personalizado que devuelve una ",(0,i.yg)("strong",{parentName:"p"},"credencial verificable")," (posiblemente usando pruebas de conocimiento cero, ZK)."),(0,i.yg)("hr",null),(0,i.yg)("h2",{id:"-1-configuraci\xf3n-del-proyecto"},"\ud83d\udce6 1. Configuraci\xf3n del Proyecto"),(0,i.yg)("h3",{id:"librer\xedas-necesarias"},"Librer\xedas necesarias"),(0,i.yg)("p",null,"Instala las dependencias:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-bash"},"npm install express axios querystring\n")),(0,i.yg)("hr",null),(0,i.yg)("h2",{id:"-2-configuraci\xf3n-del-entorno"},"\ud83d\udd10 2. Configuraci\xf3n del Entorno"),(0,i.yg)("p",null,"La app obtiene configuraciones desde variables de entorno, con valores por defecto:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},'const CLIENT_ID = process.env.REACT_APP_CLIENT_ID || "hello@example.com";\nconst CLIENT_SECRET = process.env.REACT_APP_CLIENT_SECRET || "password";\nconst REDIRECT_URI = process.env.REACT_APP_REDIRECT_URI || "http://localhost:3000/callback";\nconst AUTH_SERVER_URL = process.env.REACT_APP_AUTH_SERVER_URL || "https://app.sakundi.io";\nconst ACCOUNT = process.env.ACCOUNT || "0x86E67a05324A55AF6B2b3bF1A5cBA1778C56A8bE";\n')),(0,i.yg)("hr",null),(0,i.yg)("h2",{id:"-3-funci\xf3n-para-decodificar-jwt"},"\ud83e\uddfe 3. Funci\xf3n para Decodificar JWT"),(0,i.yg)("p",null,"Esta funci\xf3n decodifica un JWT (Base64URL) ",(0,i.yg)("strong",{parentName:"p"},"sin verificar la firma"),":"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"function parseJwt(token) {\n  const base64Url = token.split('.')[1];\n  const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\n  const jsonPayload = decodeURIComponent(atob(base64).split('').map((c) =>\n    '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)).join('')\n  );\n  return JSON.parse(jsonPayload);\n}\n")),(0,i.yg)("hr",null),(0,i.yg)("h2",{id:"-4-ruta-principal-"},"\ud83d\udeaa 4. Ruta Principal ",(0,i.yg)("inlineCode",{parentName:"h2"},"/")),(0,i.yg)("p",null,"Muestra una p\xe1gina con un enlace para iniciar la autenticaci\xf3n:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},'app.get(\'/\', (req, res) => {\n  const authUrl = `${AUTH_SERVER_URL}/authorize?` + querystring.stringify({\n    grant_type: "code",\n    client_id: CLIENT_ID,\n    client_secret: CLIENT_SECRET,\n    user_id: ACCOUNT,\n    redirect_uri: REDIRECT_URI,\n    scope: "zk-firma-digital",\n    state: String(Math.floor(Math.random() * 10000)),\n    nullifier_seed: 1000\n  });\n\n  res.send(\\`\n    <h1>Autent\xedquese con su Firma Digital</h1>\n    <p><a href="\\${authUrl}">Haga clic en el enlace para comenzar el proceso de autenticaci\xf3n</a></p>\n  \\`);\n});\n')),(0,i.yg)("p",null,"Esto redirige al usuario al servidor OAuth."),(0,i.yg)("hr",null),(0,i.yg)("h2",{id:"-5-ruta-de-callback-callback"},"\ud83d\udd04 5. Ruta de Callback ",(0,i.yg)("inlineCode",{parentName:"h2"},"/callback")),(0,i.yg)("p",null,"Maneja el retorno del servidor OAuth:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"app.get('/callback', async (req, res) => {\n  const { code, state } = req.query;\n")),(0,i.yg)("h3",{id:"paso-1-validar-el-c\xf3digo"},"Paso 1: Validar el c\xf3digo"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"  if (!code) return res.status(400).send('Se requiere c\xf3digo de autenticaci\xf3n');\n")),(0,i.yg)("h3",{id:"paso-2-intercambiar-el-c\xf3digo-por-un-token-de-acceso"},"Paso 2: Intercambiar el c\xf3digo por un token de acceso"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"  const response = await axios.post(\\`\\${AUTH_SERVER_URL}/token\\`,\n    querystring.stringify({\n      code,\n      client_id: CLIENT_ID,\n      client_secret: CLIENT_SECRET,\n      redirect_uri: REDIRECT_URI,\n      grant_type: 'authorization_code'\n    }),\n    {\n      headers: { 'Content-Type': 'application/x-www-form-urlencoded' }\n    }\n  );\n")),(0,i.yg)("h3",{id:"paso-3-mostrar-los-datos-del-token"},"Paso 3: Mostrar los datos del token"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"  const { access_token, token_type, expires_in, verifiable_credential } = response.data;\n\n  res.send(\\`\n    <html>\n      <head><title>Token Recibido</title></head>\n      <style>\n        body { font-family: sans-serif; padding: 2em; line-height: 1.5; }\n        pre { background: #f4f4f4; padding: 1em; border-radius: 4px; overflow-x: auto; }\n      </style>\n      <body>\n        <h1>\xa1Token de acceso recibido!</h1>\n        <p><strong>Tipo de Token:</strong> \\${token_type}</p>\n        <p><strong>Expira en:</strong> \\${expires_in} minutos</p>\n        <p><strong>Token:</strong></p>\n        <pre>\\${JSON.stringify(parseJwt(access_token), null, 2)}</pre>\n        <p><strong>Credencial verificable con prueba ZK:</strong></p>\n        <pre>\\${JSON.stringify(verifiable_credential, null, 2)}</pre>\n      </body>\n    </html>\n  \\`);\n")),(0,i.yg)("hr",null),(0,i.yg)("h2",{id:"-6-iniciar-el-servidor"},"\ud83d\ude80 6. Iniciar el Servidor"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"const PORT = process.env.PORT || 3000;\napp.listen(PORT, () => {\n  console.log(\\`Cliente OAuth ejecut\xe1ndose en http://localhost:\\${PORT}\\`);\n});\n")),(0,i.yg)("hr",null),(0,i.yg)("h2",{id:"-resumen"},"\u2705 Resumen"),(0,i.yg)("p",null,"Esta app:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Redirige al usuario para autenticarse con un servidor OAuth"),(0,i.yg)("li",{parentName:"ul"},"Maneja el ",(0,i.yg)("inlineCode",{parentName:"li"},"callback")," con un c\xf3digo de autorizaci\xf3n"),(0,i.yg)("li",{parentName:"ul"},"Intercambia el c\xf3digo por un token de acceso y una credencial verificable"),(0,i.yg)("li",{parentName:"ul"},"Muestra los detalles del token y credencial en el navegador")),(0,i.yg)("hr",null),(0,i.yg)("h2",{id:"-casos-de-uso"},"\ud83d\udd10 Casos de Uso"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Emisi\xf3n de identidades con pruebas de conocimiento cero"),(0,i.yg)("li",{parentName:"ul"},"Flujos de login con monederos criptogr\xe1ficos"),(0,i.yg)("li",{parentName:"ul"},"Compartir credenciales seguras en sistemas Web3 o identidad digital")))}p.isMDXComponent=!0}}]);