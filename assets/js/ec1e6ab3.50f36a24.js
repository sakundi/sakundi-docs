"use strict";(self.webpackChunktikuna=self.webpackChunktikuna||[]).push([[703],{5680:(e,n,t)=>{t.d(n,{xA:()=>u,yg:()=>h});var a=t(6540);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=a.createContext({}),c=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},u=function(e){var n=c(e.components);return a.createElement(s.Provider,{value:n},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},g=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=c(t),g=r,h=p["".concat(s,".").concat(g)]||p[g]||d[g]||i;return t?a.createElement(h,o(o({ref:n},u),{},{components:t})):a.createElement(h,o({ref:n},u))}));function h(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,o=new Array(i);o[0]=g;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l[p]="string"==typeof e?e:r,o[1]=l;for(var c=2;c<i;c++)o[c]=t[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}g.displayName="MDXCreateElement"},1359:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>c});var a=t(8168),r=(t(6540),t(5680));const i={id:"using-zikuani-third-party",title:"Using Zikuani as a provider",sidebar_label:"Using Zikuani as a provider",description:"Sakundi - Using Zikuani as a provider",keywords:["sakundi","zikuani","identity","wallet"],hide_table_of_contents:!0,custom_edit_url:null},o="\ud83e\uddea Tutorial: How to Integrate a Client with the Zikuani Wallet to Obtain Anonymous Identity Proofs",l={unversionedId:"user-section/using-zikuani-third-party",id:"user-section/using-zikuani-third-party",title:"Using Zikuani as a provider",description:"Sakundi - Using Zikuani as a provider",source:"@site/docs/user-section/using-zikuani-third-party.md",sourceDirName:"user-section",slug:"/user-section/using-zikuani-third-party",permalink:"/docs/user-section/using-zikuani-third-party",draft:!1,editUrl:null,tags:[],version:"current",frontMatter:{id:"using-zikuani-third-party",title:"Using Zikuani as a provider",sidebar_label:"Using Zikuani as a provider",description:"Sakundi - Using Zikuani as a provider",keywords:["sakundi","zikuani","identity","wallet"],hide_table_of_contents:!0,custom_edit_url:null},sidebar:"tutorialSidebar",previous:{title:"Wallet Installation",permalink:"/docs/user-section/client-installation"},next:{title:"What is ZK Voto Digital?",permalink:"/docs/user-section/what-is-zk-voto-digital"}},s={},c=[{value:"\ud83d\udce6 1. Project Setup",id:"-1-project-setup",level:2},{value:"Required Libraries",id:"required-libraries",level:3},{value:"\ud83d\udd10 2. Environment Configuration",id:"-2-environment-configuration",level:2},{value:"\ud83e\uddfe 3. JWT Decoder Function",id:"-3-jwt-decoder-function",level:2},{value:"\ud83d\udeaa 4. Root Route <code>/login</code>",id:"-4-root-route-login",level:2},{value:"\ud83d\udd04 5. Callback Route <code>/callback</code>",id:"-5-callback-route-callback",level:2},{value:"Step 1: Validate the code",id:"step-1-validate-the-code",level:3},{value:"Step 2: Exchange the code for an access token",id:"step-2-exchange-the-code-for-an-access-token",level:3},{value:"Step 3: If authentication is successful, use the token and verifiable credential data",id:"step-3-if-authentication-is-successful-use-the-token-and-verifiable-credential-data",level:3},{value:"\ud83d\ude80 6. Start the Client Server",id:"-6-start-the-client-server",level:2},{value:"\u2705 Summary",id:"-summary",level:2},{value:"See the full example at:",id:"see-the-full-example-at",level:2}],u={toc:c},p="wrapper";function d(e){let{components:n,...t}=e;return(0,r.yg)(p,(0,a.A)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,r.yg)("h1",{id:"-tutorial-how-to-integrate-a-client-with-the-zikuani-wallet-to-obtain-anonymous-identity-proofs"},"\ud83e\uddea Tutorial: How to Integrate a Client with the Zikuani Wallet to Obtain Anonymous Identity Proofs"),(0,r.yg)("p",null,"This tutorial explains how to build a Web client (JavaScript) using ",(0,r.yg)("inlineCode",{parentName:"p"},"Express.js")," and ",(0,r.yg)("inlineCode",{parentName:"p"},"axios")," to authenticate and receive a ",(0,r.yg)("strong",{parentName:"p"},"verifiable credential")," using zero-knowledge proofs. In the end, the client can get an irrefutable proof of the user's identity without needing to expose sensitive information."),(0,r.yg)("hr",null),(0,r.yg)("h2",{id:"-1-project-setup"},"\ud83d\udce6 1. Project Setup"),(0,r.yg)("h3",{id:"required-libraries"},"Required Libraries"),(0,r.yg)("p",null,"Install dependencies:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-bash"},"npm install express axios querystring\n")),(0,r.yg)("hr",null),(0,r.yg)("h2",{id:"-2-environment-configuration"},"\ud83d\udd10 2. Environment Configuration"),(0,r.yg)("p",null,"The app loads configuration from environment variables, with default values:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'// Secrets\nconst CLIENT_ID = process.env.REACT_APP_CLIENT_ID || "hello@example.com";\nconst CLIENT_SECRET = process.env.REACT_APP_CLIENT_SECRET || "password";\nconst REDIRECT_URI = process.env.REACT_APP_REDIRECT_URI || "http://localhost:3000/callback";\nconst AUTH_SERVER_URL = process.env.REACT_APP_AUTH_SERVER_URL || "https://app.sakundi.io";\nconst ACCOUNT = process.env.ACCOUNT || "user@usermail.com";\n')),(0,r.yg)("hr",null),(0,r.yg)("h2",{id:"-3-jwt-decoder-function"},"\ud83e\uddfe 3. JWT Decoder Function"),(0,r.yg)("p",null,"This function decodes a JWT (Base64URL) containing a token:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},"function parseJwt(token) {\n    try {\n        // Split the token into its parts (Header, Payload, Signature)\n        const base64Url = token.split('.')[1];\n        const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\n        const jsonPayload = decodeURIComponent(\n            atob(base64)\n                .split('')\n                .map((c) => {\n                    return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n                })\n                .join('')\n        );\n\n        return JSON.parse(jsonPayload);\n    } catch (error) {\n        console.error('Invalid token:', error);\n        return null;\n    }\n}\n")),(0,r.yg)("hr",null),(0,r.yg)("h2",{id:"-4-root-route-login"},"\ud83d\udeaa 4. Root Route ",(0,r.yg)("inlineCode",{parentName:"h2"},"/login")),(0,r.yg)("p",null,"Displays a page with a link to begin authentication:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'  app.get(\'/\', (req, res) => {\n      // Step 1: Redirect user to the OAuth server for authorization\n      const authUrl = `${AUTH_SERVER_URL}/authorize?` + querystring.stringify({\n          grant_type: "code",\n          client_id: CLIENT_ID,\n          user_id: ACCOUNT,\n          redirect_uri: REDIRECT_URI,\n          scope: "zk-firma-digital",\n          state: String(Math.floor(Math.random() * 10000)),\n          nullifier_seed: 1000\n      });\n      res.send(`\n          <h1>Authenticate with your Digital Signature</h1>\n          <p><a href="${authUrl}">Click the link to begin the authentication process</a></p>\n      `);\n  });\n')),(0,r.yg)("p",null,"This redirects the user to the Sakundi service, which then activates the Zikuani Wallet."),(0,r.yg)("hr",null),(0,r.yg)("h2",{id:"-5-callback-route-callback"},"\ud83d\udd04 5. Callback Route ",(0,r.yg)("inlineCode",{parentName:"h2"},"/callback")),(0,r.yg)("p",null,"Handles the return from the Zikuani Wallet backend server:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},"app.get('/callback', async (req, res) => {\n  const { code, state } = req.query;\n")),(0,r.yg)("h3",{id:"step-1-validate-the-code"},"Step 1: Validate the code"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},"  if (!code) return res.status(400).send('Authentication code is required');\n")),(0,r.yg)("h3",{id:"step-2-exchange-the-code-for-an-access-token"},"Step 2: Exchange the code for an access token"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},"  const response = await axios.post(\\`\\${AUTH_SERVER_URL}/token\\`,\n    querystring.stringify({\n      code,\n      client_id: CLIENT_ID,\n      client_secret: CLIENT_SECRET,\n      redirect_uri: REDIRECT_URI,\n      grant_type: 'authorization_code'\n    }),\n    {\n      headers: { 'Content-Type': 'application/x-www-form-urlencoded' }\n    }\n  );\n")),(0,r.yg)("h3",{id:"step-3-if-authentication-is-successful-use-the-token-and-verifiable-credential-data"},"Step 3: If authentication is successful, use the token and verifiable credential data"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},"    const { access_token, token_type, expires_in, verifiable_credential } = response.data;\n\n    // Display the access token\n    res.send(`\n        <html>\n        <head>\n            <title>Access Token Received</title>\n            <style>\n            body { font-family: sans-serif; padding: 2em; line-height: 1.5; }\n            h1 { color: #2c3e50; }\n            pre { background: #f4f4f4; padding: 1em; border-radius: 4px; overflow-x: auto; }\n            </style>\n        </head>\n        <body>\n            <h1>Access token received!</h1>\n            <p><strong>Token Type:</strong> ${token_type}</p>\n            <p><strong>Expires in:</strong> ${expires_in} minutes</p>\n            <p><strong>Token:</strong></p>\n            <pre>${JSON.stringify(parseJwt(access_token), null, 2)}</pre>\n            <p><strong>Verifiable Credential with ZK proof:</strong></p>\n            <pre>${JSON.stringify(verifiable_credential, null, 2)}</pre>\n        </body>\n        </html>\n    `);\n")),(0,r.yg)("hr",null),(0,r.yg)("h2",{id:"-6-start-the-client-server"},"\ud83d\ude80 6. Start the Client Server"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},"const PORT = process.env.PORT || 3000;\napp.listen(PORT, () => {\n  console.log(\\`OAuth client running at http://localhost:\\${PORT}\\`);\n});\n")),(0,r.yg)("hr",null),(0,r.yg)("h2",{id:"-summary"},"\u2705 Summary"),(0,r.yg)("p",null,"This app:"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Redirects the user to authenticate with the Zikuani Wallet backend"),(0,r.yg)("li",{parentName:"ul"},"Handles the ",(0,r.yg)("inlineCode",{parentName:"li"},"callback")," with an authorization code"),(0,r.yg)("li",{parentName:"ul"},"Exchanges the code for an access token and a verifiable credential"),(0,r.yg)("li",{parentName:"ul"},"Uses and displays the token and credential in the browser")),(0,r.yg)("p",null,"In a real-world use case, the VC would be used to grant the user access to a specific service based on properties like nationality or age."),(0,r.yg)("hr",null),(0,r.yg)("h2",{id:"see-the-full-example-at"},"See the full example at:"),(0,r.yg)("p",null,(0,r.yg)("a",{parentName:"p",href:"https://github.com/sakundi/zikuani-boilerplate"},"https://github.com/sakundi/zikuani-boilerplate")))}d.isMDXComponent=!0}}]);